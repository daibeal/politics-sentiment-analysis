<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Sentiment Analysis</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Raleway:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  
  <!-- Template Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">

  
  <py-env>
    - numpy
    - plotly
    - pandas
  </py-env>
</head>

<body>

  <!-- ======= Header ======= -->

  <!-- End Header -->

  

    <!-- ======= Testimonials Section ======= -->
    <section id="testimonials" class="testimonials">
      <div class="container" data-aos="fade-up">

        <div class="section-header">
          <h1>Sentiment Analysis</h1>
          <i class="fa-brands fa-twitter"></i>
        </div>

        <div class="slides-3 swiper" data-aos="fade-up" data-aos-delay="100">
          <div class="swiper-wrapper">

            <div class="swiper-slide">
              <div class="testimonial-wrap">
                <div class="testimonial-item">
                  <div class="d-flex align-items-center">
                    <img src="https://pbs.twimg.com/profile_images/1546025607863181315/O5o2j-80_400x400.jpg" class="testimonial-img flex-shrink-0" alt="">
                    <div>
                      <h3 id="user1">Pedro Sánchez</h3>
                      <h4 id="score1"></h4>
                    </div>
                  </div>
                </div>
              </div>
            </div><!-- End testimonial item -->
            <div class="swiper-slide">
              <div class="testimonial-wrap">
                <div class="testimonial-item">
                  <div class="d-flex align-items-center">
                    <img src="https://img2.rtve.es/css/rtve.elecciones/rtve.elecciones.nacional/i/lideres.png/vox_santiago-abascal.png" class="testimonial-img flex-shrink-0" alt="">
                    <div>
                      <h3 id="user2">Santiago Abascal</h3>
                      <h4 id="score2"></h4>
                    </div>
                  </div>
                </div>
              </div>
            </div><!-- End testimonial item -->
            <div class="swiper-slide">
              <div class="testimonial-wrap">
                <div class="testimonial-item">
                  <div class="d-flex align-items-center">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Yolanda_D%C3%ADaz_2020_%28cropped%29.jpg" class="testimonial-img flex-shrink-0" alt="">
                    <div>
                      <h3 id="user3">Yolanda Díaz</h3>
                      <h4 id="score3"></h4>
                    </div>
                  </div>
                </div>
              </div>
            </div><!-- End testimonial item -->
            <div class="swiper-slide">
              <div class="testimonial-wrap">
                <div class="testimonial-item">
                  <div class="d-flex align-items-center">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/Carmen_Calvo_2020_%28portrait%29.jpg/640px-Carmen_Calvo_2020_%28portrait%29.jpg" class="testimonial-img flex-shrink-0" alt="">
                    <div>
                      <h3 id="user4">Carmen Calvo</h3>
                      <h4 id="score4"></h4>
                    </div>
                  </div>
                </div>
              </div>
            </div><!-- End testimonial item -->
            <div class="swiper-slide">
              <div class="testimonial-wrap">
                <div class="testimonial-item">
                  <div class="d-flex align-items-center">
                    <img src="https://www.lamoncloa.gob.es/gobierno/PublishingImages/GobiernoEnero2020/14012020_Mar%C3%ADa%20Jes%C3%BAs%20Montero.jpg?RenditionID=31" class="testimonial-img flex-shrink-0" alt="">
                    <div>
                      <h3 id="user5">María Jesus Montero</h3>
                      <h4 id="score5"></h4>
                    </div>
                  </div>
                </div>
              </div>
            </div><!-- End testimonial item -->
            <div class="swiper-slide">
              <div class="testimonial-wrap">
                <div class="testimonial-item">
                  <div class="d-flex align-items-center">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Isabel_D%C3%ADaz_Ayuso_en_el_s%C3%A9ptimo_aniversario_de_El_Huffpost_%28cropped%29.jpg/1200px-Isabel_D%C3%ADaz_Ayuso_en_el_s%C3%A9ptimo_aniversario_de_El_Huffpost_%28cropped%29.jpg" class="testimonial-img flex-shrink-0" alt="">
                    <div>
                      <h3 id="user6">Isabel Díaz Ayuso</h3>
                      <h4 id="score6"></h4>
                    </div>
                  </div>
                </div>
              </div>
            </div><!-- End testimonial item -->


          </div>
          <div class="swiper-pagination"></div>
        </div>

      </div>
    </section><!-- End Testimonials Section -->
    
    <section id="chart">
      
      <div  data-aos="fade-up">
        <div id='chart1' data-aos = "fade-up" style="text-align: center; border: none; width: 100%;">

          <!-- <img src="https://storage.googleapis.com/bucket-elastic/plot.png" alt=""> -->
        </div>
      </div>
     
    </section>
    

    <script type='text/javascript'>
      function plot(graph, chart) {
          var figure = JSON.parse(graph)
          Plotly.newPlot(chart, figure, {});
      }
  </script>

<py-script id="main">
  import numpy as np
  import pandas as pd
  import plotly.graph_objects as go
  import js
  from js import document
  import plotly.express as px

  sc1 = document.getElementById("score1").innerHTML
  sc2 = document.getElementById("score2").innerHTML
  sc3 = document.getElementById("score3").innerHTML
  sc4 = document.getElementById("score4").innerHTML
  sc5 = document.getElementById("score5").innerHTML
  sc6 = document.getElementById("score6").innerHTML

  sc1 = float(sc1)
  sc2 = float(sc2)
  sc3 = float(sc3)
  sc4 = float(sc4)
  sc5 = float(sc5)
  sc6 = float(sc6)




  user = ['Pedro Sánchez', 'Santiago Abascal', 'Yolanda Díaz', 'Carmen Calvo','María Jesús Montero' ,'Isabel Díaz Ayuso']
  score = [sc1, sc2, sc3, sc4, sc5, sc6]

  fig = px.bar(x=user, y=score, labels={'x':'User', 'y':'Score'}, color=user, color_discrete_sequence=px.colors.qualitative.Dark24)
  
  fig.update_xaxes(tickangle=45)
  fig.update_layout(template='plotly_white')
  fig.update_layout(title_text='Sentiment Analysis of Spanish Politicians')
  fig.update_layout(
    autosize=False,
    width=1400,
    height=800,
    margin=dict(
        l=50,
        r=50,
        b=100,
        t=100,
        pad=4
    )
  )
  

  



  js.plot(fig.to_json(), "chart1")
</py-script>

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">

    

    <div class="container mt-4">
      <div class="copyright">
        &copy; Copyright <strong><a href="https://www.andresbenites.es" style="color: turquoise"> <span> Andrés B. Aldaz </span> </a></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        
      </div>
    </div>
    <script>
      const url = "https://storage.googleapis.com/download/storage/v1/b/bucket-elastic/o/scores.json?alt=media"

      var xhr = new XMLHttpRequest();
      xhr.open("GET", url);
      var data2;

      xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      // console.log(xhr.status);
      // add to variables
      data2 = JSON.parse(xhr.responseText);
      // get first element first name
      // function to render data set interval
      renderData(data2, 20)
      
  

      
      
    
   }};
    xhr.send();
    
  function renderData(data2, seconds){

    while(true){
      var tit = document.getElementById("user1")
      tit.innerHTML = "@" + data2[0].User
      var valu = document.getElementById("score1")
      valu.innerHTML = data2[0].Score
      var tit1 = document.getElementById("user2")
      tit1.innerHTML = "@" +data2[1].User
      var val1 = document.getElementById("score2")
      val1.innerHTML = data2[1].Score
      var tit2 = document.getElementById("user3")
      tit2.innerHTML = "@" +data2[2].User
      var val2 = document.getElementById("score3")
      val2.innerHTML = data2[2].Score
      var tit3 = document.getElementById("user4")
      tit3.innerHTML = "@" +data2[3].User
      var val3 = document.getElementById("score4")
      val3.innerHTML = data2[3].Score
      var tit4 = document.getElementById("user5")
      tit4.innerHTML = "@" +data2[4].User
      var val4 = document.getElementById("score5")
      val4.innerHTML = data2[4].Score
      var tit5 = document.getElementById("user6")
      tit5.innerHTML = "@" +data2[5].User
      var val5 = document.getElementById("score6")
      val5.innerHTML = data2[5].Score
      sleep(seconds*1000);

    }
    
  }

    
    


    </script>

  </footer><!-- End Footer -->
  <!-- End Footer -->

  <a href="#" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script defer src="https://pyscript.net/alpha/pyscript.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>